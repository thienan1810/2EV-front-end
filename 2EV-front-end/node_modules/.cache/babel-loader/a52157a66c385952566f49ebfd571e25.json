{"ast":null,"code":"import _regeneratorRuntime from \"/Users/thienanvu/Desktop/2EV-front-end/2EV-front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/thienanvu/Desktop/2EV-front-end/2EV-front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/thienanvu/Desktop/2EV-front-end/2EV-front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/thienanvu/Desktop/2EV-front-end/2EV-front-end/src/views/DashboardPage/ServiceList.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport { ListItem, ListItemAvatar, ListItemSecondaryAction, ListItemText, Avatar, IconButton, List } from \"@material-ui/core\";\nimport { useSelector } from \"react-redux\";\nimport moment from \"moment\";\nimport FolderIcon from \"@material-ui/icons/Event\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nvar API_BASE = \"http://localhost:8080\";\n\nvar ServiceList = function ServiceList(_ref) {\n  var setHasEvents = _ref.setHasEvents;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      events = _useState2[0],\n      setEvents = _useState2[1];\n\n  var token = useSelector(function (state) {\n    return state.user.token;\n  });\n  var isAdmin = useSelector(function (state) {\n    return state.user.isAdmin;\n  });\n  useEffect(function () {\n    var fetchEvents =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var url, result, _ref3, appointments, newEvents;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                url = \"\".concat(API_BASE, \"/booking\");\n                _context.next = 3;\n                return fetch(url, {\n                  method: \"GET\",\n                  headers: {\n                    Authorization: token,\n                    \"Content-Type\": \"application/json\"\n                  }\n                });\n\n              case 3:\n                result = _context.sent;\n                _context.next = 6;\n                return result.json();\n\n              case 6:\n                _ref3 = _context.sent;\n                appointments = _ref3.appointments;\n                newEvents = appointments.map(function (_ref4) {\n                  var title = _ref4.title,\n                      end = _ref4.end,\n                      start = _ref4.start,\n                      number = _ref4.number,\n                      name = _ref4.name,\n                      _id = _ref4._id;\n                  return {\n                    title: title,\n                    end: end,\n                    start: start,\n                    number: number,\n                    name: name,\n                    _id: _id\n                  };\n                });\n                setEvents(newEvents);\n                setHasEvents(newEvents.length > 0);\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function fetchEvents() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    var fetchEventsAdmin =\n    /*#__PURE__*/\n    function () {\n      var _ref5 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var url, result, _ref6, appointments, newEvents;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                url = \"\".concat(API_BASE, \"/booking/adminFetch\");\n                _context2.next = 3;\n                return fetch(url, {\n                  method: \"GET\",\n                  headers: {\n                    Authorization: token,\n                    \"Content-Type\": \"application/json\"\n                  }\n                });\n\n              case 3:\n                result = _context2.sent;\n                _context2.next = 6;\n                return result.json();\n\n              case 6:\n                _ref6 = _context2.sent;\n                appointments = _ref6.appointments;\n                newEvents = appointments.map(function (_ref7) {\n                  var title = _ref7.title,\n                      end = _ref7.end,\n                      start = _ref7.start,\n                      number = _ref7.number,\n                      name = _ref7.name,\n                      _id = _ref7._id;\n                  return {\n                    title: title,\n                    end: end,\n                    start: start,\n                    number: number,\n                    name: name,\n                    _id: _id\n                  };\n                });\n                setEvents(newEvents);\n                setHasEvents(newEvents.length > 0);\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function fetchEventsAdmin() {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n\n    if (isAdmin) {\n      fetchEventsAdmin();\n    } else {\n      fetchEvents();\n    } //fetchEvents();\n\n  }, []);\n\n  var deleteEvent =\n  /*#__PURE__*/\n  function () {\n    var _ref8 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3(_id) {\n      var url, result, updatedEvents;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              url = \"\".concat(API_BASE, \"/booking/delete\");\n              _context3.next = 3;\n              return fetch(url, {\n                method: \"POST\",\n                body: JSON.stringify({\n                  _id: _id\n                }),\n                headers: {\n                  Authorization: token,\n                  \"Content-Type\": \"application/json\"\n                }\n              });\n\n            case 3:\n              result = _context3.sent;\n              updatedEvents = events.filter(function (event) {\n                return event._id !== _id;\n              });\n              setEvents(updatedEvents);\n              setHasEvents(updatedEvents.length > 0);\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function deleteEvent(_x) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var getListItems = function getListItems() {\n    return events.map(function (event, index) {\n      return React.createElement(ListItem, {\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, React.createElement(ListItemAvatar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }, React.createElement(Avatar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }, React.createElement(FolderIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }))), React.createElement(ListItemText, {\n        primary: isAdmin ? event.title + \" with \" + event.name : event.title,\n        secondary: moment(event.start).format(\"LLL\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }), React.createElement(ListItemSecondaryAction, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, React.createElement(IconButton, {\n        edge: \"end\",\n        \"aria-label\": \"delete\",\n        onClick: function onClick() {\n          return deleteEvent(event._id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, React.createElement(DeleteIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }))));\n    });\n  };\n\n  return React.createElement(List, {\n    dense: false,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, getListItems());\n};\n\nexport default ServiceList;","map":{"version":3,"sources":["/Users/thienanvu/Desktop/2EV-front-end/2EV-front-end/src/views/DashboardPage/ServiceList.jsx"],"names":["React","useState","useEffect","ListItem","ListItemAvatar","ListItemSecondaryAction","ListItemText","Avatar","IconButton","List","useSelector","moment","FolderIcon","DeleteIcon","API_BASE","ServiceList","setHasEvents","events","setEvents","token","state","user","isAdmin","fetchEvents","url","fetch","method","headers","Authorization","result","json","appointments","newEvents","map","title","end","start","number","name","_id","length","fetchEventsAdmin","deleteEvent","body","JSON","stringify","updatedEvents","filter","event","getListItems","index","format"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  ListItem,\n  ListItemAvatar,\n  ListItemSecondaryAction,\n  ListItemText,\n  Avatar,\n  IconButton,\n  List\n} from \"@material-ui/core\";\nimport { useSelector } from \"react-redux\";\nimport moment from \"moment\";\n\nimport FolderIcon from \"@material-ui/icons/Event\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nconst API_BASE = \"http://localhost:8080\";\n\nconst ServiceList = ({ setHasEvents }) => {\n  const [events, setEvents] = useState([]);\n  const token = useSelector(state => state.user.token);\n  const isAdmin = useSelector(state => state.user.isAdmin);\n\n  useEffect(() => {\n    const fetchEvents = async () => {\n      const url = `${API_BASE}/booking`;\n      const result = await fetch(url, {\n        method: \"GET\",\n        headers: {\n          Authorization: token,\n          \"Content-Type\": \"application/json\"\n        }\n      });\n      const { appointments } = await result.json();\n      const newEvents = appointments.map(\n        ({ title, end, start, number, name, _id }) => ({\n          title,\n          end,\n          start,\n          number,\n          name,\n          _id\n        })\n      );\n      setEvents(newEvents);\n      setHasEvents(newEvents.length > 0);\n    };\n\n    const fetchEventsAdmin = async () => {\n      const url = `${API_BASE}/booking/adminFetch`;\n      const result = await fetch(url, {\n        method: \"GET\",\n        headers: {\n          Authorization: token,\n          \"Content-Type\": \"application/json\"\n        }\n      });\n      const { appointments } = await result.json();\n      const newEvents = appointments.map(\n        ({ title, end, start, number, name, _id }) => ({\n          title,\n          end,\n          start,\n          number,\n          name,\n          _id\n        })\n      );\n      setEvents(newEvents);\n      setHasEvents(newEvents.length > 0);\n    };\n\n    if (isAdmin) {\n      fetchEventsAdmin();\n    } else {\n      fetchEvents();\n    }\n\n    //fetchEvents();\n  }, []);\n\n  const deleteEvent = async _id => {\n    const url = `${API_BASE}/booking/delete`;\n    const result = await fetch(url, {\n      method: \"POST\",\n      body: JSON.stringify({ _id }),\n      headers: {\n        Authorization: token,\n        \"Content-Type\": \"application/json\"\n      }\n    });\n\n    const updatedEvents = events.filter(event => event._id !== _id);\n    setEvents(updatedEvents);\n    setHasEvents(updatedEvents.length > 0);\n  };\n\n  const getListItems = () => {\n    return events.map((event, index) => (\n      <ListItem key={index}>\n        <ListItemAvatar>\n          <Avatar>\n            <FolderIcon />\n          </Avatar>\n        </ListItemAvatar>\n        <ListItemText\n          primary={isAdmin ? event.title + \" with \" + event.name: event.title}\n          secondary={moment(event.start).format(\"LLL\")}\n        />\n        <ListItemSecondaryAction>\n          <IconButton\n            edge=\"end\"\n            aria-label=\"delete\"\n            onClick={() => deleteEvent(event._id)}\n          >\n            <DeleteIcon />\n          </IconButton>\n        </ListItemSecondaryAction>\n      </ListItem>\n    ));\n  };\n\n  return <List dense={false}>{getListItems()}</List>;\n};\n\nexport default ServiceList;\n\n\n"]},"metadata":{},"sourceType":"module"}